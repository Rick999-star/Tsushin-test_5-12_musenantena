<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>無線アンテナ 学習サイト - 実力テスト 第1回</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
        }
        .question-container {
            border: 2px solid transparent;
            transition: border-color 0.3s ease-in-out;
        }
        .correct-border {
            border-color: #22c55e; /* green-500 */
            background-color: #f0fdf4; /* green-50 */
        }
        .incorrect-border {
            border-color: #ef4444; /* red-500 */
            background-color: #fef2f2; /* red-50 */
        }
        .answer-feedback {
            display: none;
            padding: 0.75rem;
            margin-top: 0.75rem;
            border-radius: 0.375rem;
            background-color: #f3f4f6; /* gray-100 */
        }
        .correct-answer-text {
             font-weight: 700;
             color: #16a34a; /* green-600 */
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen text-gray-800">
    <div class="container mx-auto p-4 md:p-8 max-w-4xl">
        
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-blue-700">5-12 無線アンテナ 学習サイト</h1>
            <h2 class="text-2xl md:text-3xl font-semibold text-gray-700 mt-2">実力テスト 第1回 (20問)</h2>
        </header>
        
        <main id="content-main">
            <!-- スコア表示領域 -->
            <div id="score-container" class="text-center mb-6" style="display: none;">
                <!-- スコアはここに挿入されます -->
            </div>

            <!-- 問題表示領域 -->
            <div id="quiz-container" class="space-y-6">
                <!-- 実力テスト問題はここに挿入されます -->
            </div>

            <!-- 採点ボタン -->
            <button id="grade-button" class="w-full mt-10 bg-green-600 text-white font-bold text-lg py-3 px-6 rounded-lg shadow-md hover:bg-green-700 transition duration-300 ease-in-out">
                採点する
            </button>
        </main>

        <footer class="text-center mt-12">
            <a href="index.html" class="text-blue-600 hover:underline">&laquo; トップページに戻る</a>
        </footer>
    </div>
    
    <script>
        // 実力テスト第1回データ
        const testData = {
          "assessment_test_1": [
            {
              "questionNumber": 1,
              "type": "multiple_choice",
              "question": "アンテナの利得を示す「dBi」という単位の「i」が示す基準アンテナは何か？",
              "options": [
                "半波長ダイポールアンテナ",
                "八木・宇田アンテナ",
                "等方性放射体",
                "1メートルの導線"
              ],
              "answer": "等方性放射体",
              "hint": "理論上の、全方向に均等に放射するアンテナを基準としています。"
            },
            {
              "questionNumber": 2,
              "type": "fill_in_the_blank",
              "question": "半波長ダイポールアンテナの放射抵抗値は、理論上約（　　）Ωである。",
              "keywords": ["73"],
              "hint": "2桁の数字です。整合がとりやすい値とされています。"
            },
            {
              "questionNumber": 3,
              "type": "multiple_choice",
              "question": "八木・宇田アンテナに関する記述のうち、誤っているものはどれか？",
              "options": [
                "放射器、反射器、導波器の3要素で構成される。",
                "放射器の長さは、ほぼ1/2波長である。",
                "反射器は、放射器より少し短く、容量性のインピーダンスとして働く。",
                "導波器の数を増やすと、利得を高くすることができる。"
              ],
              "answer": "反射器は、放射器より少し短く、容量性のインピーダンスとして働く。",
              "hint": "反射器は「長く」、特性は「誘導性」です。"
            },
            {
              "questionNumber": 4,
              "type": "multiple_choice",
              "question": "周波数 $f$ [MHz] と波長 $\\lambda$ [m] の関係式 $f \\times \\lambda = 300$ を用いて、周波数150MHzの電波の波長を求めよ。",
              "options": [
                "0.5 m",
                "1.0 m",
                "1.5 m",
                "2.0 m"
              ],
              "answer": "2.0 m",
              "hint": "$\\lambda = 300 / 150$ を計算します。"
            },
            {
              "questionNumber": 5,
              "type": "fill_in_the_blank",
              "question": "ブラウンアンテナ（グランドプレーンアンテナ）の放射素子の長さは、使用する電波の波長の（　　）である。",
              "keywords": ["1/4", "4分の1", "0.25"],
              "hint": "半波長ダイポールの半分、と考えると覚えやすいかもしれません。"
            },
            {
              "questionNumber": 6,
              "type": "multiple_choice",
              "question": "アンテナの指向特性において、ビームの鋭さを示す指標であり、電力が最大値の半分になる2点間の角度を何というか？",
              "options": [
                "絶対利得",
                "半値角（半値幅）",
                "サイドローブ",
                "実効長"
              ],
              "answer": "半値角（半値幅）",
              "hint": "電力が「半」分の「値」になる「角」度です。"
            },
            {
              "questionNumber": 7,
              "type": "multiple_choice",
              "question": "パラボラアンテナの一次放射器やその支持柱によって電波が遮られ、サイドローブの発生や利得低下の原因となる現象を何というか？",
              "options": [
                "ブロッキング",
                "フェージング",
                "リフレクション",
                "インピーダンス"
              ],
              "answer": "ブロッキング",
              "hint": "「遮断」や「妨害」を意味する英単語です。"
            },
            {
              "questionNumber": 8,
              "type": "fill_in_the_blank",
              "question": "ブロッキングを避けるために、パラボラ反射鏡の中心からずれた部分だけを利用するアンテナを（　　）パラボラアンテナという。",
              "keywords": ["オフセット"],
              "hint": "英語で「ずらす」という意味です。BSアンテナによく使われます。"
            },
            {
              "questionNumber": 9,
              "type": "multiple_choice",
              "question": "電磁ホーンアンテナに関する記述のうち、正しいものはどれか？",
              "options": [
                "ホーンの開き角を大きくするほど、平面波に近づく。",
                "主に低い周波数帯（長波）で使用される。",
                "利得測定の標準アンテナとして用いられることがある。",
                "インピーダンス特性は広帯域にわたり良好である。"
              ],
              "answer": "利得測定の標準アンテナとして用いられることがある。",
              "hint": "安定した特性を持つため、基準として使われます。"
            },
            {
              "questionNumber": 10,
              "type": "fill_in_the_blank",
              "question": "コーナレフレクタアンテナにおいて、開き角90度の場合、反射板の頂点からダイポールまでの距離Sが（　　）のときに最も理想的なビーム（単一指向性）となる。（ $\\lambda$ を波長とする）",
              "keywords": ["$\\lambda / 2$", "λ/2", "2分のλ"],
              "hint": "波長の半分（Half Wavelength）がキーとなる距離です。"
            },
            {
              "questionNumber": 11,
              "type": "multiple_choice",
              "question": "アンテナの送信指向性と受信指向性は同じ特性を持つという原理を何というか？",
              "options": [
                "双対性",
                "可逆性（相反性）",
                "等価性の原理",
                "オームの法則"
              ],
              "answer": "可逆性（相反性）",
              "hint": "送信でも受信でも同じ性能、という意味です。「双対性」は電界と磁界の関係などで使われる別の用語です。"
            },
            {
              "questionNumber": 12,
              "type": "fill_in_the_blank",
              "question": "半波長ダイポールアンテナの水平面内指向性は、（　　）の字の特性となる。",
              "keywords": ["8", "八"],
              "hint": "素子と直角の方向に強く放射されます。"
            },
            {
              "questionNumber": 13,
              "type": "multiple_choice",
              "question": "パラボラアンテナの構成要素として正しい組み合わせはどれか？",
              "options": [
                "反射器、放射器、導波器",
                "放物面反射器、一次放射器",
                "放射素子、地線（グランドプレーン）",
                "V字型の反射板、ダイポール"
              ],
              "answer": "放物面反射器、一次放射器",
              "hint": "パラボラ（放物線）の鏡と、そこに電波を送る部分からなります。"
            },
            {
              "questionNumber": 14,
              "type": "multiple_choice",
              "question": "八木アンテナにおいて、電波を前方に導き、指向性を鋭くする役割を持つ要素は何か？",
              "options": [
                "放射器",
                "反射器",
                "導波器",
                "給電部"
              ],
              "answer": "導波器",
              "hint": "放射器よりも短い素子です。"
            },
            {
              "questionNumber": 15,
              "type": "fill_in_the_blank",
              "question": "大地雑音の影響を低減する目的などで、主反射鏡（回転放物面）と副反射鏡（回転双曲面）を組み合わせたアンテナを（　　）アンテナという。",
              "keywords": ["カセグレン"],
              "hint": "天体望遠鏡にも同じ名前の方式があります。"
            },
            {
              "questionNumber": 16,
              "type": "multiple_choice",
              "question": "半波長ダイポールアンテナの実効長 $l$ を求める式はどれか？（ $\\lambda$ は波長）",
              "options": [
                "$l = \\lambda / \\pi$",
                "$l = \\lambda / 2\\pi$",
                "$l = \\lambda / 2$",
                "$l = \\lambda / 4$"
              ],
              "answer": "$l = \\lambda / \\pi$",
              "hint": "円周率 $\\pi$ が分母に出てきます。"
            },
            {
              "questionNumber": 17,
              "type": "fill_in_the_blank",
              "question": "アンテナの指向特性で、主ビーム以外の意図しない方向に放射される弱い電波を（　　）と総称する。",
              "keywords": ["サイドローブ"],
              "hint": "メインローブの「横」に出るものです。"
            },
            {
              "questionNumber": 18,
              "type": "multiple_choice",
              "question": "パラボラアンテナの鏡面の精度が劣化した場合に起こる現象として、正しいものはどれか？",
              "options": [
                "利得が上昇し、サイドローブが低下する。",
                "利得が低下し、サイドローブが上昇する。",
                "利得のみが低下し、サイドローブに影響はない。",
                "利得もサイドローブも変化しない。"
              ],
              "answer": "利得が低下し、サイドローブが上昇する。",
              "hint": "反射が乱れ、意図した方向に電波が集中しなくなります。"
            },
            {
              "questionNumber": 19,
              "type": "multiple_choice",
              "question": "地上デジタル放送の受信用アンテナとして広く使われている、複数の素子で構成された指向性の高いアンテナは何か？",
              "options": [
                "ホイップアンテナ",
                "八木・宇田アンテナ",
                "ブラウンアンテナ",
                "パラボラアンテナ"
              ],
              "answer": "八木・宇田アンテナ",
              "hint": "魚の骨のような形をしていることが多いアンテナです。"
            },
            {
              "questionNumber": 20,
              "type": "fill_in_the_blank",
              "question": "電磁ホーンアンテナから放射される電磁波は、平面波ではなく（　　）波であるため、拡散しやすい。",
              "keywords": ["球面波"],
              "hint": "パラボラアンテナで平面波に変換されます。"
            }
          ]
        };

        const questions = testData.assessment_test_1 || [];

        // 数式レンダリング関数
        function renderLatex(text) {
            if (typeof text !== 'string') return text;
            return text.replace(/\$([^$]+?)\$/g, (match, p1) => p1) // $...$ の $ を削除
                       .replace(/\\lambda/g, 'λ') // \lambda を λ に
                       .replace(/\\pi/g, 'π')    // \pi を π に
                       .replace(/\\times/g, '×'); // \times を × に
        }

        // ページ読み込み時に問題を描画
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('quiz-container');
            if (!container) return;

            questions.forEach((q, index) => {
                const qIndex = index + 1;
                let contentHtml = '';
                
                // LATEX表記をレンダリング（簡易版）
                const questionText = renderLatex(q.question);


                if (q.type === 'multiple_choice') {
                    // 4択問題のHTML
                    const optionsHtml = q.options.map(option => `
                        <label class="flex items-center p-3 rounded-md border border-gray-300 hover:bg-gray-50 cursor-pointer">
                            <input type="radio" name="q${qIndex}" value="${option}" class="mr-3">
                            <span>${renderLatex(option)}</span>
                        </label>
                    `).join('');
                    contentHtml = `<div class="space-y-2">${optionsHtml}</div>`;
                } else if (q.type === 'fill_in_the_blank') {
                    // 穴埋め問題のHTML
                    contentHtml = `
                        <div class="space-y-2">
                             <input type="text" id="q${qIndex}-input" placeholder="答えを入力" class="w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        </div>
                    `;
                }

                // 問題全体のHTML
                const questionHtml = `
                    <div class="bg-white p-4 md:p-6 rounded-lg shadow-md question-container" id="question-${qIndex}">
                        <p class="text-lg font-semibold mb-4">Q${q.questionNumber}: ${questionText}</p>
                        ${contentHtml}
                        <div id="feedback-${qIndex}" class="answer-feedback">
                            <!-- 解答フィードバックはここに挿入されます -->
                        </div>
                    </div>
                `;
                container.innerHTML += questionHtml;
            });

            // 採点ボタンのイベントリスナーを設定
            document.getElementById('grade-button').addEventListener('click', gradeTest);
        });

        // 採点機能
        function gradeTest(event) {
            let score = 0;
            
            questions.forEach((q, index) => {
                const qIndex = index + 1;
                const qDiv = document.getElementById(`question-${qIndex}`);
                const fDiv = document.getElementById(`feedback-${qIndex}`);
                let isCorrect = false;
                let correctAnswerHtml = '';

                // クラスをリセット
                qDiv.classList.remove('correct-border', 'incorrect-border');

                if (q.type === 'multiple_choice') {
                    const selected = document.querySelector(`input[name="q${qIndex}"]:checked`);
                    if (selected && selected.value === q.answer) {
                        isCorrect = true;
                    }
                    correctAnswerHtml = `<p><strong>正解: </strong><span class="correct-answer-text">${renderLatex(q.answer)}</span></p>`;
                } else if (q.type === 'fill_in_the_blank') {
                    const input = document.getElementById(`q${qIndex}-input`);
                    const userAnswer = input.value.trim();
                    const keywords = q.keywords;
                    
                    if (userAnswer) {
                        for (const keyword of keywords) {
                            // ユーザーの回答がキーワードのいずれかを含んでいれば正解
                            if (userAnswer.includes(keyword)) {
                                isCorrect = true;
                                break;
                            }
                        }
                    }
                    correctAnswerHtml = `<p><strong>正解 (キーワード): </strong><span class="correct-answer-text">${q.keywords.map(renderLatex).join('、')}</span></p>`;
                }

                // UIを更新
                if (isCorrect) {
                    score++;
                    qDiv.classList.add('correct-border');
                } else {
                    qDiv.classList.add('incorrect-border');
                }
                
                fDiv.innerHTML = correctAnswerHtml;
                fDiv.style.display = 'block';
            });

            // 総合スコアを表示
            const scoreContainer = document.getElementById('score-container');
            scoreContainer.innerHTML = `<h2 class="text-3xl font-bold text-gray-800">あなたのスコア: <span class="${score > (questions.length / 2) ? 'text-green-600' : 'text-red-600'}">${score} / ${questions.length} 点</span></h2>`;
            scoreContainer.style.display = 'block';

            // 採点ボタンを無効化
            const gradeButton = event.target;
            gradeButton.disabled = true;
            gradeButton.textContent = '採点済み';
            gradeButton.classList.add('bg-gray-400', 'cursor-not-allowed');
            gradeButton.classList.remove('bg-green-600', 'hover:bg-green-700');

            // ページ上部にスクロール
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>